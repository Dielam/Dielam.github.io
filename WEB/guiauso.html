<!DOCTYPE HTML>
<!--
	Landed by HTML5 UP
	html5up.net | @ajlkn
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>
	<head>
		<title>Guia de uso</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
		<link rel="stylesheet" href="assets/css/main.css" />
		<noscript><link rel="stylesheet" href="assets/css/noscript.css" /></noscript>
	</head>
	<body class="is-preload">
		<div id="page-wrapper">

			<!-- Header -->
				<header id="header">
					<nav id="nav">
						<ul>
							<li><a href="index.html" class="button primary">Inicio</a></li>
							<li>
								<a href="#" class="button primary">Proyecto</a>
								<ul>
									<li><a href="dataset.html">Dataset</a></li>
									<li><a href="herramientas.html">Herramientas</a></li>
									<li><a href="guiauso.html">Guia de uso</a>
										<ul>
											<li><a href="opciones.html"> Opciones de ejecución</a></li>
										</ul>
									</li>
									<li><a href="resultados.html">Resultados</a></li>
								</ul>
							</li>
							<li><a href="index.html#repositorio" class="button primary">Repositorio</a></li>
							<li><a href="index.html#miembros" class="button primary">Miembros</a></li>
							<li><a href="index.html#contacto" class="button primary">Contacto</a></li>
						</ul>
					</nav>
				</header>

			<!-- Main -->
				<div id="main" class="wrapper style1">
					<div class="container">
						<header class="major">
							<h2>Guia de uso del programa</h2>
							<p></p>
						</header>

						<!-- Content -->
							<section id="content">
								<a href="#" class="image fit"><img src="images/accidente.jpg" alt="" /></a>
								<h2>Preparación del programa</h2>
								<p>Tenemos 2 formas de ejecutar las opciones del programa, en modo local, y a través de una instancia de Amazon
								Web Services. A continuación, se explica como utilizar cada una de ellas.</p>
								<h3>Modo local</h3>
								<p>Si queremos ejecutar este programa en modo local, ya sea en vuestro sistema operativo Linux Ubuntu o en
								Windows pero a través de una máquina virtual de Ubuntu (con VirtualBox, por ejemplo), es necesario tener instalado en nuestro equipo Spark en modo local, si no lo tienes o no sabes como hacerlo, aquí tienes un tutorial para conseguirlo.</p>

								<h4>Instalación Spark en nuestra máquina Ubuntu</h4>
								<p>Aunque pensemos que podemos tener todo instalado, si no estamos correctamente seguros, realizaremos los siguientes
								pasos:<br>
								Primero, instalaremos Java, ya que es necesario para arrancar Apache Spark</p>
								<pre><code>$ sudo apt-get update
$ sudo apt install default-jdk</code></pre>
								<p>Después, será necesarior instalar Scala y comprobar la correcta instalación y version.
								<pre><code>$ sudo apt-get install scala
$ scala -version
Scala code runner version 2.11.12 -- Copyright 2002-2017, LAMP/EPF</code></pre>
								<p>Tras esto, instalaremos Python</p>
								<pre><code>$ sudo apt-get install python</code></pre>
								<p>Para comprobar la instalación, ejecutamos:</p>
								<pre><code>$ python -h</code></pre>
								<p>Por último, instalamos Spark</p>
								<pre><code>$ sudo curl -o http://d3kbcqa49mib13.cloudfront.net/spark-2.2.0-bin-hadoop2.7.tgz
$ sudo tar xvf ./spark-2.2.0-bin-hadoop2.7.tgz
$ sudo mkdir /usr/local/spark
$ sudo cp -r spark-2.2.0-bin-hadoop2.7/* /usr/local/spark</code></pre>
								<p>Puede ser que nuestra máquina no reconozca el comando curl, en este caso, procederemos a instalarlo
								y a continuación, volveremos a realizar el paso anterior</p>
								<pre><code>$ sudo apt install curl</code></pre>

								<p>También tendrás que instalar los paquete Pandas, Numpy y unicodecsv, que puedes conseguir mediante estos comandos</p>
								<pre><code>$ sudo apt-get install python-pip
$ sudo pip install numpy
$ sudo pip install pandas
$ sudo pip install unicodecsv</code></pre>

								<h3>Amazon Web Services</h3>
								<p>Para ejecutar la aplicación mediante un clúster, será necesario iniciar un clúster con Spark en Hadoop a través de Amazon AWS. Después de iniciar el clúster, instalaremos Pandas, Numpy y unicodecsv igual que para la ejecución en modo local, esta vez sin sudo:</p>
																<pre><code>$ sudo apt-get install python-pip
$ pip install numpy
$ pip install pandas
$ pip install unicodecsv</code></pre>
								<p>En caso de aparecer un error con el comando pip, tendremos que actualizarlo:</p>
								<pre><code>$ pip install --upgrade pip</code></pre>
								<p>Al estar ejecutando la aplicación en un clúster, los comandos cambian, para ejecutar cualquier opcion, lo haremos de la siguiente forma (donde N y M son los número que queramos poner):</p>
								<pre><code>$ spark-submit --num-executors N --executor-cores M "script"</code></pre>
								<p>Una vez ejecutado el script, necesitamos obtener la carpeta de salida del hadoop file system, para ello:</p>
								<pre><code>$ hadoop fs -get "nombreDirectorioSalida"</code></pre>
								<p>Si queremos volver a ejecutar el mismo código con otras opciones habría que borrar los ficheros de salida generados en la ejecución anterior, para ello, utilizamos los siguientes comandos:</p>
								<pre><code>$ hadoop fs -rm -r "nombreDirectorioSalida"</code></pre>
								<p>Para consultar los directorios:</p>
								<pre><code>$ hadoop fs -ls</code></pre>


							<h2>Opciones de ejecución</h2>
							<p>Antes de seleccionar cualquiera de las opciones que nuestro programa procesará, será necesario descargar el csv de ese día, para ello, debe ejecutar:</p>
							<pre><code>$ spark-submit spark_descargarCSV.py</code></pre>
							<p>Ahora si, selecciona una opción para saber como ejecutarla</p>
							<br>
							<ul class="actions">
							<li><a href="opciones.html#MediaCP" class="button">Media de precio de cada combustible por Código Postal</a></li>
							</ul>
							<ul class="actions">
							<li><a href="opciones.html#MediaEMP" class="button">Media de precio de cada combustible por Empresa</a></li>
							</ul>
							<ul class="actions">
							<li><a href="opciones.html#MediaLOC" class="button">Media de precio de cada combustible por Localidad</a></li>
							</ul>
							<ul class="actions">
							<li><a href="opciones.html#ListaPorCP" class="button">Lista de gasolineras a partir de un Código Postal</a></li>
							</ul>
							<ul class="actions">
							<li><a href="opciones.html#ListaPorLoc" class="button">Lista de gasolineras en una Localidad</a></li>
							</ul>
							<ul class="actions">
							<li><a href="opciones.html#ListaPorEmp" class="button">Lista de gasolineras pertenecientes a una Empresa</a></li>
							</ul>
							<ul class="actions">
							<li><a href="opciones.html#MaxCP" class="button">Precio máximo de cada combustible a partir de un Código Postal</a></li>
							</ul>
							<ul class="actions">
							<li><a href="opciones.html#MaxLOC" class="button">Precio máximo de cada combustible a partir de una localidad</a></li>
							</ul>
							<ul class="actions">
							<li><a href="opciones.html#MaxEMP" class="button">Precio máximo de cada combustible en una Empresa</a></li>
							</ul>
							<ul class="actions">
							<li><a href="opciones.html#MinCP" class="button">Precio mínimo de cada combustible a partir de un Código Postal</a></li>
							</ul>
							<ul class="actions">
							<li><a href="opciones.html#MinLOC" class="button">Precio mínimo de cada combustible a partir de una localidad</a></li>
							</ul>
							<ul class="actions">
							<li><a href="opciones.html#MinEMP" class="button">Precio mínimo de cada combustible en una Empresa</a></li>
							</ul>
							</section>

					</div>
				</div>

			<!-- Footer -->
				<footer id="footer">
					<ul class="icons">
						<li><a href="https://github.com/Dielam/Dielam.github.io" class="icon brands alt fa-github"><span class="label">GitHub</span></a></li>

					</ul>
					<ul class="copyright">
						<li>&copy; Untitled. All rights reserved.</li><li>Design: <a href="http://html5up.net">HTML5 UP</a></li>
					</ul>
				</footer>

		</div>

		<!-- Scripts -->
			<script src="assets/js/jquery.min.js"></script>
			<script src="assets/js/jquery.scrolly.min.js"></script>
			<script src="assets/js/jquery.dropotron.min.js"></script>
			<script src="assets/js/jquery.scrollex.min.js"></script>
			<script src="assets/js/browser.min.js"></script>
			<script src="assets/js/breakpoints.min.js"></script>
			<script src="assets/js/util.js"></script>
			<script src="assets/js/main.js"></script>

	</body>
</html>